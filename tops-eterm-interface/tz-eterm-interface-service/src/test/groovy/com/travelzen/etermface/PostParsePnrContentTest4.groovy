package com.travelzen.etermface

import com.travelzen.etermface.service.PNRParser
import org.apache.http.HttpResponse
import org.apache.http.NameValuePair
import org.apache.http.client.ClientProtocolException
import org.apache.http.client.entity.UrlEncodedFormEntity
import org.apache.http.client.methods.HttpPost
import org.apache.http.impl.client.DefaultHttpClient
import org.apache.http.message.BasicNameValuePair
import org.apache.http.protocol.HTTP
import org.apache.http.util.EntityUtils
import org.slf4j.Logger
import org.slf4j.LoggerFactory

/**
 * @author liang.wang
 *
 */
class PostParsePnrContentTest4 {

	private static Logger logger = LoggerFactory.getLogger(PNRParser.class);

	static main(args) {

		def pnrContent =
 
'''*ELECTRONIC TICKET PNR* 
0.18NGJQ NM18 JPR638 
1.CHENG/YAN 2.KIM/MINKYEONG 3.LI/QING 4.LI/SHIHAO 5.LIU/ENYAN 6.LIU/RONG 
7.PAN/SONGHAO 8.RUAN/YINGFEI 9.WANG/CHEN 10.WANG/ZHEN CHD 11.XIE/GUANGWEN 
12.XIE/JIAWEI 13.YANG/MINXING 14.YANG/MINYAN CHD 15.YANG/WEIGE 
16.ZHANG/MINGMING 17.ZHOU/GUOYING 18.ZHOU/LIENA 
19. HO1317 U TU01OCT PVGBKK HK18 2120 0015+1 E T2-- 
20. HO1320 U SU06OCT BKKPVG HK18 1905 2350 E --T2 
21.SHA/T SHA/T021-62277798/BU YE CHENG BOOKING OFFICE/JINHUA ABCDEFG 
22.REM 0719 1522 WJBHNG 52520570 
23.021-52062617 
24.T 
25.SSR TKNE HO HK1 PVGBKK 1317 U01OCT 0184173780545/1/P18 
26.SSR TKNE HO HK1 PVGBKK 1317 U01OCT 0184173780544/1/P17 
27.SSR TKNE HO HK1 PVGBKK 1317 U01OCT 0184173780543/1/P16 
28.SSR TKNE HO HK1 PVGBKK 1317 U01OCT 0184173780542/1/P15 
29.SSR TKNE HO HK1 PVGBKK 1317 U01OCT 0184173780541/1/P14 
30.SSR TKNE HO HK1 PVGBKK 1317 U01OCT 0184173780540/1/P13 
31.SSR TKNE HO HK1 PVGBKK 1317 U01OCT 0184173780539/1/P12 
32.SSR TKNE HO HK1 PVGBKK 1317 U01OCT 0184173780538/1/P11 
33.SSR TKNE HO HK1 PVGBKK 1317 U01OCT 0184173780537/1/P10 
34.SSR TKNE HO HK1 PVGBKK 1317 U01OCT 0184173780536/1/P9 +
35.SSR TKNE HO HK1 PVGBKK 1317 U01OCT 0184173780535/1/P8 -
36.SSR TKNE HO HK1 PVGBKK 1317 U01OCT 0184173780534/1/P7 
37.SSR TKNE HO HK1 PVGBKK 1317 U01OCT 0184173780533/1/P6 
38.SSR TKNE HO HK1 PVGBKK 1317 U01OCT 0184173780532/1/P5 
39.SSR TKNE HO HK1 PVGBKK 1317 U01OCT 0184173780531/1/P4 
40.SSR TKNE HO HK1 PVGBKK 1317 U01OCT 0184173780530/1/P3 
41.SSR TKNE HO HK1 PVGBKK 1317 U01OCT 0184173780529/1/P2 
42.SSR TKNE HO HK1 PVGBKK 1317 U01OCT 0184173780528/1/P1 
43.SSR TKNE HO HK1 BKKPVG 1320 U06OCT 0184173780528/2/P1 
44.SSR TKNE HO HK1 BKKPVG 1320 U06OCT 0184173780529/2/P2 
45.SSR TKNE HO HK1 BKKPVG 1320 U06OCT 0184173780530/2/P3 
46.SSR TKNE HO HK1 BKKPVG 1320 U06OCT 0184173780531/2/P4 +
47.SSR TKNE HO HK1 BKKPVG 1320 U06OCT 0184173780532/2/P5 -
48.SSR TKNE HO HK1 BKKPVG 1320 U06OCT 0184173780533/2/P6 
49.SSR TKNE HO HK1 BKKPVG 1320 U06OCT 0184173780534/2/P7 
50.SSR TKNE HO HK1 BKKPVG 1320 U06OCT 0184173780535/2/P8 
51.SSR TKNE HO HK1 BKKPVG 1320 U06OCT 0184173780536/2/P9 
52.SSR TKNE HO HK1 BKKPVG 1320 U06OCT 0184173780537/2/P10 
53.SSR TKNE HO HK1 BKKPVG 1320 U06OCT 0184173780538/2/P11 
54.SSR TKNE HO HK1 BKKPVG 1320 U06OCT 0184173780539/2/P12 
55.SSR TKNE HO HK1 BKKPVG 1320 U06OCT 0184173780540/2/P13 
56.SSR TKNE HO HK1 BKKPVG 1320 U06OCT 0184173780541/2/P14 
57.SSR TKNE HO HK1 BKKPVG 1320 U06OCT 0184173780542/2/P15 
58.SSR TKNE HO HK1 BKKPVG 1320 U06OCT 0184173780543/2/P16 +
59.SSR TKNE HO HK1 BKKPVG 1320 U06OCT 0184173780544/2/P17 -
60.SSR TKNE HO HK1 BKKPVG 1320 U06OCT 0184173780545/2/P18 
61.SSR DOCS HO HK1 P/CHN/GN4022585/CHN/17MAY86/F/01JUL18/KIM/MINKYEONG/P2 
62.SSR DOCS HO HK1 P/CHN/G60424870/CHN/17OCT84/F/07MAR22/ZHANG/MINGMING/P16 
63.SSR DOCS HO HK1 P/CHN/G56140619/CHN/01JUN83/M/23OCT21/PAN/SONGHAO/P7 
64.SSR DOCS HO HK1 P/CHN/E05661540/CHN/03JAN89/F/07NOV22/ZHOU/LIENA/P18 
65.SSR DOCS HO HK1 P/CHN/E25865370/CHN/06NOV88/F/12SEP23/ZHOU/GUOYING/P17 
66.SSR DOCS HO HK1 P/CHN/G50624491/CHN/05SEP74/F/07APR21/LIU/RONG/P6 
67.SSR DOCS HO HK1 P/CHN/G50624480/CHN/14NOV00/M/07APR16/LI/SHIHAO/P4 
68.SSR DOCS HO HK1 P/CHN/G50624481/CHN/24APR70/M/07APR21/LI/QING/P3 
69.SSR DOCS HO HK1 P/CHN/E30140808/CHN/28DEC06/M/08SEP18/WANG/ZHEN/P10 
70.SSR DOCS HO HK1 P/CHN/E02676672/CHN/28JUN72/M/25JUL22/WANG/CHEN/P9 +
71.SSR DOCS HO HK1 P/CHN/E02676667/CHN/04JUL76/F/25JUL22/RUAN/YINGFEI/P8 -
72.SSR DOCS HO HK1 P/CHN/G35008326/CHN/25FEB03/F/19APR14/YANG/MINYAN/P14 
73.SSR DOCS HO HK1 P/CHN/G45397828/CHN/01MAY72/F/07SEP20/CHENG/YAN/P1 
74.SSR DOCS HO HK1 P/CHN/G35008327/CHN/04JAN72/M/19APR19/YANG/WEIGE/P15 
75.SSR DOCS HO HK1 P/CHN/G45397811/CHN/07MAR98/F/07SEP15/YANG/MINXING/P13 
76.SSR DOCS HO HK1 P/CHN/E23425034/CHN/10OCT97/M/09JUL18/XIE/JIAWEI/P12 
77.SSR DOCS HO HK1 P/CHN/E23426461/CHN/01DEC67/M/09JUL23/XIE/GUANGWEN/P11 
78.SSR DOCS HO HK1 P/CHN/E15432605/CHN/28NOV73/F/11APR23/LIU/ENYAN/P5 
79.SSR CHLD HO HK1 28DEC06/P10 
80.SSR CHLD HO HK1 25FEB03/P14 
81.OSI HO CTCT13564688640 
82.RMK TJ SHA255 +
83.RMK CA/MDK1Y9 -
84.FN/FCNY8700.00/SCNY3300.00/C5.00/XCNY1182.00/TCNY90.00CN/TCNY142.00TS/ 
TCNY950.00YQ/ACNY9882.00 
85.FN/FCNY6530.00/SCNY3300.00/C5.00/XCNY1092.00/TEXEMPTCN/TCNY142.00TS/ 
TCNY950.00YQ/ACNY7622.00/P10/14 
86.TN/018-4173780528/P1 
87.TN/018-4173780529/P2 
88.TN/018-4173780530/P3 
89.TN/018-4173780531/P4 
90.TN/018-4173780532/P5 
91.TN/018-4173780533/P6 
92.TN/018-4173780534/P7 +
93.TN/018-4173780535/P8 -
94.TN/018-4173780536/P9 
95.TN/018-4173780537/P10 
96.TN/018-4173780538/P11 
97.TN/018-4173780539/P12 
98.TN/018-4173780540/P13 
99.TN/018-4173780541/P14 
100.TN/018-4173780542/P15 
101.TN/018-4173780543/P16 
102.TN/018-4173780544/P17 
103.TN/018-4173780545/P18 
104.FP/CASH,CNY +
105.SHA255 -'''
				

		HttpPost httpost = new HttpPost("http://localhost:8380/eterm-interface/PnrContentParser");
//		 httpost = new HttpPost("http://192.168.160.183:8080/etermface-interfaces/PnrContentParser");
		
//		http://localhost:8180/etermface-interfaces/PnrContentParser

		List<NameValuePair> nvps = new ArrayList <NameValuePair>();

		nvps.add(new BasicNameValuePair("pnrContent", pnrContent ));
		
//		nvps.add(new BasicNameValuePair("isDomestic", "true" ));
		nvps.add(new BasicNameValuePair("isDomestic", "false" ));
		nvps.add(new BasicNameValuePair("needFare", "true" ));
		
		 

		try {
			logger.info("set utf-8 form entity to httppost");
			httpost.setEntity(new UrlEncodedFormEntity(nvps, HTTP.UTF_8));
			
			HttpResponse response = null;
			  
			try {
				DefaultHttpClient httpclient = new DefaultHttpClient();
				response = httpclient.execute(httpost);
				
				System.out.println(response.getEntity().toString());
				
				println EntityUtils.toString(response.getEntity(), "utf-8");
						
				
			} catch (ClientProtocolException e) {
				e.printStackTrace();
			} catch (IOException e) {
				e.printStackTrace();
			}
			
		} catch (UnsupportedEncodingException e) {
			e.printStackTrace();
		}
 
	}
}
